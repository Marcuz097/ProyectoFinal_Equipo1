<!-- Hereda la estructura general desde base.html -->
{% extends "base.html" %}

<!-- Carga los archivos estáticos (CSS, imágenes, JS, etc.) -->
{% load static %}

<!-- Bloque que define el título que se mostrará en la pestaña del navegador -->
{% block titulo %} Lista de Especialidades {% endblock %}

<!-- Bloque donde se incluye la hoja de estilo específica para esta vista -->
{% block extra_css %}
<link rel="stylesheet" href="{% static 'core/css/CSS-personalizado/especialidad-list.css' %}">
{% endblock %}

<!-- Inicio del bloque principal del contenido -->
{% block contenido %}

<!-- Contenedor general con padding vertical -->
<div class="container py-4">

    <!-- Encabezado de la sección con el título y botón de acción -->
    <div
        class="header-dynamic-block d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">

        <!-- Título principal con ícono -->
        <h1 class="text-deep-navy">
            <i class="bi bi-clipboard2-pulse-fill me-3 text-contrast-blue"></i>
            Lista de Especialidades
        </h1>

        <!-- Botón para agregar una nueva especialidad -->
        <a href="{% url 'gestion_citas:especialidad-create' %}" class="btn btn-main-action rounded-pill mt-3 mt-md-0">
            <i class="bi bi-plus-circle-fill me-2"></i> Nueva Especialidad
        </a>
    </div>

    <!-- Bloque del buscador/filtro -->
    <div class="row filter-container">
        <div class="col-12 col-md-8 col-lg-6 mx-auto">
            <div class="search-input-wrapper">
                <!-- Campo de entrada para filtrar especialidades -->
                <input type="text" id="filtro" class="form-control"
                    placeholder="Buscar especialidades por nombre o ID...">
                <!-- Ícono de lupa -->
                <i class="bi bi-search"></i>
            </div>
        </div>
    </div>

    <!-- Condicional: si existen especialidades registradas -->
    {% if especialidades %}

    <!-- Grid de tarjetas de especialidades -->
    <div class="row g-4">
        {% for e in especialidades %}
        <!-- Cada especialidad ocupa una columna responsiva -->
        <div class="col-12 col-sm-6 col-lg-4">
            <!-- Tarjeta individual (item filtrable) -->
            <div class="card widget-consolidated h-100 filtro-item">

                <!-- Encabezado de la tarjeta con el nombre -->
                <div class="widget-navy-header">
                    <h3 class="specialty-title-header text-truncate" title="{{ e.nombre }}">
                        {{ e.nombre }}
                    </h3>
                </div>

                <!-- Cuerpo de la tarjeta con ícono y ID -->
                <div class="widget-body-clean">
                    <i class="bi bi-patch-check-fill widget-main-icon"></i>

                    <!-- Muestra un identificador visual (contador del bucle) -->
                    <span class="id-tag">
                        <i class="bi bi-key-fill me-2"></i> ID: <strong>{{ forloop.counter }}</strong>
                    </span>
                </div>

                <!-- Pie de tarjeta con acciones (editar y eliminar) -->
                <div class="widget-footer-actions">
                    <!-- Enlace para editar -->
                    <a href="{% url 'gestion_citas:especialidad-update' pk=e.pk %}"
                        class="btn btn-outline-marine btn-action-wide">
                        <i class="bi bi-pencil-square"></i> Editar
                    </a>
                    <!-- Enlace para eliminar -->
                    <a href="{% url 'gestion_citas:especialidad-delete' pk=e.pk %}"
                        class="btn btn-delete-outline-innovador btn-action-wide">
                        <i class="bi bi-trash"></i> Eliminar
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Si no hay especialidades registradas -->
    {% else %}
    <div class="alert alert-info text-center shadow-lg border-0 py-5" style="background-color: #e6f3ff;">
        <!-- Mensaje informativo -->
        <h4 class="alert-heading text-deep-navy">
            <i class="bi bi-emoji-frown me-3"></i> No se encontraron Especialidades
        </h4>
        <p class="mb-0 text-secondary">
            Utiliza el botón <strong>"Nueva Especialidad"</strong> para comenzar a registrar datos en el sistema.
        </p>

        <!-- Botón para registrar una nueva especialidad -->
        <a href="{% url 'gestion_citas:especialidad-create' %}" class="btn btn-main-action mt-3 rounded-pill">
            <i class="bi bi-plus-circle-fill me-2"></i> Registrar Especialidad
        </a>
    </div>
    {% endif %}
</div>

<!-- Script para el filtro dinámico de especialidades -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const input = document.getElementById("filtro"); // Campo de texto del filtro
        const items = document.querySelectorAll(".filtro-item"); // Tarjetas a filtrar

        input.addEventListener("input", function () {
            const texto = input.value.toLowerCase().trim(); // Texto ingresado en el buscador

            // Recorre todas las tarjetas para ocultar o mostrar según la coincidencia
            items.forEach(item => {
                const contenido = item.innerText.toLowerCase(); // Texto completo de la tarjeta
                // Muestra si contiene el texto buscado, oculta si no coincide
                item.style.display = contenido.includes(texto) ? "" : "none";
            });
        });
    });
</script>

{% endblock contenido %}
